<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BNails_MAUI.Views.Registro"
             xmlns:vm="clr-namespace:BNails_MAUI.ViewModels"
             xmlns:popup="clr-namespace:BNails_MAUI.Views.Popups"
             x:DataType="vm:RegistroViewModel"
             Shell.NavBarIsVisible="False"
             Title="Registro">

    <Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#ffccd5" Offset="0.0" />
                <GradientStop Color="#ffb563" Offset="1.0" />
            </LinearGradientBrush>
        </Grid.Background>

        <ScrollView HorizontalOptions="Center">

            <VerticalStackLayout
                Spacing="20"
                VerticalOptions="Center"
                HorizontalOptions="Center"
                Padding="30, 0"
                WidthRequest="400">

                <Image
                    Source="logo_principal.png"
                    WidthRequest="220"
                    HeightRequest="220"
                    Margin="0,-60,0,-40"
                    HorizontalOptions="Center"/>

                <Label
                    Text="Registrate"
                    Margin="0,0,0,10"
                    Style="{StaticResource LabelHeaderInicio}" />

                <Border
                    Style="{StaticResource MainBorder}">

                    <Grid ColumnDefinitions="30,*">
                        <Image Source="user1.png"
                            WidthRequest="20"
                            HeightRequest="20"
                            VerticalOptions="Center" />
                        <Entry Grid.Column="1"
                            Placeholder="Ingresa tu nombre"
                            TextColor="Black"
                            BackgroundColor="Transparent"
                            Margin="5,0,0,0"
                            PlaceholderColor="{StaticResource Gray400}"
                            Text="{Binding Nombre}" />
                    </Grid>
                </Border>

                <Border
                    Style="{StaticResource MainBorder}">

                    <Grid ColumnDefinitions="30,*">
                        <Image Source="correo.png"
                            WidthRequest="20"
                            HeightRequest="20"
                            VerticalOptions="Center" />
                        <Entry Grid.Column="1"
                            Placeholder="Ingresa tu correo electrónico"
                            TextColor="Black"
                            BackgroundColor="Transparent"
                            Keyboard="Email"
                            Margin="5,0,0,0"
                            PlaceholderColor="{StaticResource Gray400}"
                            Text="{Binding Email, Mode=TwoWay}"/>
                    </Grid>
                </Border>

                <Label
                    Text="Formato correcto: 'ejemplo@mail.com'"
                    TextColor="#c1121f"
                    Margin="0,-15,0,0"
                    IsVisible="{Binding MostrarFormatoEmail}" />

                <Border
                    Style="{StaticResource MainBorder}">

                    <Grid ColumnDefinitions="30,*">
                        <Image Source="candado.png"
                            WidthRequest="20"
                            HeightRequest="20"
                            VerticalOptions="Center" />
                        <Entry Grid.Column="1"                               
                            x:Name="txtPasswordRegistro"
                            Placeholder="Ingresa la contraseña"
                            IsPassword="True"
                            TextColor="Black"
                            BackgroundColor="Transparent"
                            Margin="5,0,0,0"
                            PlaceholderColor="{StaticResource Gray400}"
                            Text="{Binding Password}" />
                    </Grid>
                </Border>

                <StackLayout Margin="0,-20,0,0">
                    <Label
                        Text="❌ Mínimo 8 caracteres"
                        TextColor="Red"
                        IsVisible="{Binding MostrarMinCaracteres}" />

                    <Label
                        Text="❌ Al menos una mayúscula"
                        TextColor="Red"
                        IsVisible="{Binding MostrarMayuscula}" />

                    <Label
                        Text="❌ Al menos un número"
                        TextColor="Red"
                        IsVisible="{Binding MostrarNumero}" />

                </StackLayout>

                <Border
                    Style="{StaticResource MainBorder}">

                    <Grid ColumnDefinitions="30,*">
                        <Image Source="candado.png"
                            WidthRequest="20"
                            HeightRequest="20"
                            VerticalOptions="Center" />
                        <Entry Grid.Column="1"
                            x:Name="txtRePasswordRegistro"
                            Placeholder="Ingresa nuevamente la contraseña"
                            IsPassword="True"
                            TextColor="Black"
                            BackgroundColor="Transparent"
                            Margin="5,0,0,0"
                            PlaceholderColor="{StaticResource Gray400}"
                            Text="{Binding RePassword}" />
                    </Grid>
                </Border>

                <Label
                    Text="Las contraseñas deben ser iguales"
                    TextColor="{StaticResource DarkRedColor}"
                    Margin="0,-20,0,0"
                    IsVisible="{Binding MostrarCoincidencia}" />

                <StackLayout
                    Orientation="Horizontal"
                    VerticalOptions="Center"
                    HorizontalOptions="End">
                    
                    <Label
                        Text="Mostrar contraseña"
                        TextColor="DarkBlue"
                        CharacterSpacing="1"
                        Style="{StaticResource SubHeadline}"
                        FontSize="16"
                        FontAttributes="Bold"
                        VerticalOptions="Center"/>

                    <CheckBox
                        x:Name="ShowPasswordCheckBox"
                        Color="DarkBlue"
                        CheckedChanged="OnShowPasswordCheckBox_Registro"
                        VerticalOptions="Center"/>

                </StackLayout>

                <Button
                    Text="Crear usuario"
                    Margin="0,20"
                    Style="{ StaticResource BotonesInicio }"
                    Command="{Binding RegistrarCommand}" />

                <Label
                    Text="Volver al Inicio de Sesión"
                    Style="{ StaticResource LabelInicio }">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Tapped="VolverLogin_Tapped"/>
                    </Label.GestureRecognizers>
                </Label>
                
            </VerticalStackLayout>
            
        </ScrollView>

        <popup:LoadingPopup x:Name="loadingPopup" />

    </Grid>

</ContentPage>